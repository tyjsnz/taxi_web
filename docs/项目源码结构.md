# 项目结构

## 根目录
- `src/` - 项目源代码目录
  - `auth/` - 身份验证相关代码
    - `auth_middleware.py` - 用户身份验证中间件
  - `common/` - 通用功能模块
    - `const_defined.py` - 常量定义
  - `controller/` - 控制器目录
    - `app/` - App 端控制器
      - `dispatch/` - 调度员控制器
        - `dispatch_controller.py` - 调度员控制器
      - `driver/` - 司机控制器
        - `driver_controller.py` - 司机控制器
      - `base_controller.py` - 司机乘客控制器基类
    - `wechat/` - 微信端控制器
      - `wechat_controller.py` - 微信端控制器
    - `SchedulerTaskController.py` - 后台调度任务控制器
    - `MqttController.py` - MQTT 控制器
  - `helper/` - 辅助功能目录
    - `helper.py` - 辅助功能实现
    - `captcha.py` - 验证码生成器
    - `http_helper.py` - HTTP 请求辅助功能实现
    - `qrcode_helper.py` - 二维码生成器
    - `upload_service.py` - 文件上传服务
    - `wechat_api.py` - 微信 API
    - `mqtt_client.py` - MQTT 客户端封装
    - `sms_helper.py` - 短信发送帮助类
  - `model/` - 数据模型目录
    - `admin/` - 管理员相关数据模型 
      - `user_db.py` - 管理员用户数据模型
      - `company/` - 公司相关数据模型
        - `company_db.py` - 公司数据库操作模型
    - `driving/` - 驾驶相关数据模型
      - `drive_db.py` - 驾驶数据库操作
      - `driver_account_db.py` - 司机账户数据模型
      - `driver_db.py` - 司机端数据库操作
    - `order/` - 订单相关数据模型
      - `order_db.py` - 订单数据库操作
      - `order_complaint_db.py` - 订单投诉数据模型
      - `order_rating_db.py` - 订单评价数据模型
      - `order_transfer_db.py` - 订单转单调度数据模型
    - `coupon/` - 优惠券相关数据模型
      - `coupon_db.py` - 优惠券数据库操作
      - `user_coupons_db.py` - 用户优惠券数据库操作
    - `wechat/` - 微信相关数据模型
      - `wechat_user_db.py` - 微信用户数据库操作
    - `map/` - 地图相关数据模型
      - `map_fence_db.py` - 地图电子围栏数据库操作
    - `common/` - 通用数据模型
      - `region_db.py` - 地区数据库模型
    - `db_redis.py` - Redis 数据库操作
    - `db_memcached.py` - Memcached 数据库操作
    - `base_db.py` - 数据库实现类（继承自db_redis.py）
    - `database_inspectory.py` - 数据库表结构检查
  - `routes/` - 路由目录
    - `admin/` - 管理员端路由
      - `admin_route.py` - 管理员端公共路由
    - `app/` - App 端路由
      - `app_route.py` - App 端公共路由
      - `driver/` - 司机端路由
      - `scheduler/` - 调度端路由 
    - `wechat/` - 微信端路由
      - `wechat_route.py` - 微信端公共路由
  - `service/` - 服务层
    - `payment/` - 支付服务
      - `wechat_pay_service.py` - 微信支付服务
- `app.py` - 项目入口文件，包含项目的配置和路由设置。
- `settings.py` - 配置文件
- `requirements.txt` - 项目依赖包列表
- `static/` - 静态文件目录如：css, js, images
- `templates/` - 模板文件目录
  - `admin/` - 管理员端模板
    - `goupons/` - 优惠券管理模板
      - `coupon_list.html` - 优惠券列表
      - `add_coupon.html` - 添加优惠券
    - `monitor/` - 监控管理模板
      - `map_region.html` - 电子围栏地图
    - `driver_car/` - 司机车辆管理模板
      - `driver_car_list.html` - 司机车辆列表
- `docs/` - 文档目录
- `log/` - 日志目录

## 文件说明
- `auth_middleware.py` - 包含用户身份验证中间件，用于验证用户 token 是否有效。
- `index_controller.py` - App 端首页控制器，处理首页相关的请求。
- `wechat_controller.py` - 微信端控制器，处理微信端相关的请求。
- `helper.py` - 辅助功能实现，包含项目中使用的各种辅助函数。
- `drive_db.py` - 驾驶数据库操作，包含与驾驶相关的数据操作。
- `wechat_user_db.py` - 微信用户数据库操作，包含与微信用户相关的数据操作。
- `app_route.py` - App 端公共路由，定义了 App 端的路由和中间件。
- `wechat_route.py` - 微信端公共路由，定义了微信端的路由和中间件。
- `settings.py` - 配置文件，包含项目的配置信息。

## 路由中间件
- `auth_middleware` - 用于验证用户 token 是否有效，不同端需要放行的路由通过参数传入放行。
- `auth_wechat_middleware` - 微信小程序身份验证中间件，验证用户 token 是否有效。

## 示例路由
- `app_route.py` - App 端路由示例，包含首页和关于我们的路由。
- `wechat_route.py` - 微信端路由示例，包含首页路由。